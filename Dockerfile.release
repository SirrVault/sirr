# Dockerfile.release — used by CI with pre-built musl binaries
FROM scratch
ARG TARGETARCH
COPY dist/${TARGETARCH}/sirrd /sirrd

# Data directory — mount a volume here for persistence.
VOLUME ["/data"]

ENV SIRR_DATA_DIR=/data \
    SIRR_HOST=0.0.0.0 \
    SIRR_PORT=39999

EXPOSE 39999

ENTRYPOINT ["/sirrd"]
CMD ["serve"]
